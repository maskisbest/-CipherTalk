import router from '@ohos.router'

import { AgentModel } from '../model/AgentModel'
import ListChatItem, { ChatItemData } from '../../component/ListChatItem'
import WechatToolbar from '../../component/WechatToolbar'


@Preview
@Component
export default struct Home {
    @State chatList: ChatItemData[] = [

        {
            headSrc: $r("app.media.ic_user_head2"),
            nickname: "è€å©†",
            content: "ä»Šæ™šç»™ä½ åšäº†å¥½åƒçš„ï¼Œæ—©ç‚¹ä¸‹ç­å“¦ğŸ˜Š",
            time: "17:21"
        },
        {
            headSrc: $r("app.media.ic_user_head3"),
            nickname: "æ¸¸æˆå¥½å‹",
            content: "æˆ‘ä»Šå¤©åˆæ‹¿äº†äº”æ€ï¼Œç‰›é€¼ä¸ï¼Ÿ",
            time: "15:38"
        },
        { headSrc: $r("app.media.ic_user_head4"),
            nickname: "åŒäº‹å°æ",
            content: "é¢†å¯¼ï¼ŒæŠ¥ç»™å†™å¥½äº†ï¼Œè¯·è¿‡ç›®",
            time: "14:12"
        },
        { headSrc: $r("app.media.ic_user_head5"),
            nickname: "HRå°å­™",
            content: "è¿™ä¸ªå²—ä½è¿˜éœ€è¦æ‹›ä¸¤ä¸ªäºº",
            time: "12:08"
        },
        { headSrc: $r("app.media.ic_user_head6"),
            nickname: "å®¢æˆ·å°æ½˜",
            content: "è¿™æ˜¯æˆ‘ä»¬å…¬å¸çš„æŠ¥ä»·ï¼Œå¸Œæœ›æ‚¨èƒ½è€ƒè™‘ä¸‹",
            time: "æ˜¨å¤©" },
        { headSrc: $r("app.media.ic_user_head7"),
            nickname: "è€å¼Ÿ",
            content: "å¥½çš„ï¼Œå“¥",
            time: "å‘¨ä¸€" }
    ]

    build() {
        Column() {
            WechatToolbar({ title: "ç§˜è¯­(5)" })
            // æ·»åŠ æ™ºèƒ½ä½“å…¥å£ä½œä¸ºç‰¹æ®ŠåŠŸèƒ½åŒº
            Row() {
                Image($r("app.media.ic_ai_agent"))
                    .width(40)
                    .height(40)
                    .margin(10)
                Column() {
                    Text("æˆ‘çš„æ™ºèƒ½ä½“")
                        .fontSize(16)
                        .fontColor(Color.Black)
                    Text("AIåŠ©æ‰‹éšæ—¶ä¸ºæ‚¨æœåŠ¡")
                        .fontSize(12)
                        .fontColor('#666')
                }
                .layoutWeight(1)
            }
            .width('100%')
            .backgroundColor(Color.White)
            .padding(5)
            .onClick(() => {
                const agent = new AgentModel(
                    "https://www.coze.cn/store/agent/7528984685125861427?bot_id=true",
                    "æˆ‘çš„æ™ºèƒ½ä½“"
                );
                router.pushUrl({
                    url: 'pages/AgentPage/AgentPage',
                    params: agent
                })
            })


            List() {
                ForEach(this.chatList, (item: ChatItemData, index: number) => {
                    ListItem() {
                        ListChatItem({ data: item })
                    }
                    .onClick(() => {
                        if (item.nickname === "æˆ‘çš„æ™ºèƒ½ä½“") {
                            // åˆ›å»ºæ™ºèƒ½ä½“å¯¹è±¡
                            const agent = new AgentModel(
                                "https://www.coze.cn/store/agent/7528984685125861427?bot_id=true",
                                "æˆ‘çš„æ™ºèƒ½ä½“"
                            );

                            // è·³è½¬åˆ°æ™ºèƒ½ä½“é¡µé¢
                            router.pushUrl({
                                url: 'pages/AgentPage/AgentPage',
                                params: agent
                            })
                        } else {
                            // æ™®é€šèŠå¤©è·³è½¬
                            router.pushUrl({
                                url: 'pages/chat/ChatPage',
                                params: {name:item.nickname}
                            })
                        }
                    })
                })
                ListItem() {
                    Divider().color('#0000').strokeWidth(0)
                }
            }
            .divider({ strokeWidth: 0.8, color: '#f0f0f0', startMargin: 90, endMargin: 0 }) // æ¯è¡Œä¹‹é—´çš„åˆ†ç•Œçº¿
            .backgroundColor(Color.White)
            .width("100%")
            .height("100%")

        }
        .width("100%")
        .height("100%")
        .backgroundColor("#f0f0f0")
    }
}
